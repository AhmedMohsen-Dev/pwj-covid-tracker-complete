const buildChartData=e=>{let t,a=[];for(let o in e.cases){if(t){let n={x:o,y:e.cases[o]-t};a.push(n)}t=e.cases[o]}return a},buildChart=e=>{var t=document.getElementById("myChart").getContext("2d");new Chart(t,{type:"line",data:{datasets:[{backgroundColor:"rgba(204, 16, 52, 0.5)",borderColor:"#CC1034",data:e}]},options:{legend:{display:!1},elements:{point:{radius:0}},maintainAspectRatio:!1,tooltips:{mode:"index",intersect:!1,callbacks:{label:function(e,t){return numeral(e.value).format("+0,0")}}},scales:{xAxes:[{type:"time",time:{format:"MM/DD/YY",tooltipFormat:"ll"}}],yAxes:[{gridLines:{display:!1},ticks:{callback:function(e,t,a){return numeral(e).format("0a")}}}]}}})};var mapStyle=[{elementType:"geometry",stylers:[{color:"#B2A4A4"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f5f5"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#dadada"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#e5e5e5"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#eeeeee"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#F3F2F8"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]}];const startUIDropdown=e=>{$(".ui.dropdown").dropdown({values:e,onChange:function(e,t){changeCountrySelection(e)}})};var map,infoWindow;let coronaGlobalData;window.onload=(()=>{getCountriesData(),getHistoricalData(),getWorldCoronaData(),setHoverState()});let mapCircles=[],countrySelection="worldwide",mapCenter={lat:34.80746,lng:-40.4796},worldwideSelect={name:"Worldwide",value:"worldwide",selected:!0};var casesTypeColors={cases:"#CC1034",active:"#9d80fe",recovered:"#7dd71d",deaths:"#fb4443"};function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:mapCenter,zoom:2,styles:mapStyle,mapTypeControl:!1,fullscreenControl:!1,streetViewControl:!1}),infoWindow=new google.maps.InfoWindow}const changeCountrySelection=e=>{e!==countrySelection&&(e==worldwideSelect.value?getWorldCoronaData(e):getCountryCoronaData(e),countrySelection=e)},changeDataSelection=e=>{setSelectedTab(e),changeMapTitle(e),clearTheMap(),showDataOnMap(coronaGlobalData,e)},changeMapTitle=e=>{let t=e.charAt(0).toUpperCase()+e.slice(1);document.querySelector(".map-header h4").textContent=`Coronavirus ${t}`},setHoverState=()=>{$(".card").hover(function(){$(this).find(".tab-selection").not(".selected").fadeIn(200)},function(){$(this).find(".tab-selection").not(".selected").fadeOut(200)})},updateDate=e=>{let t=moment(e).format("[Last Updated] MMMM DD, YYYY");document.querySelector(".map-header .date").textContent=t},clearTheMap=()=>{for(let e of mapCircles)e.setMap(null)},setSelectedTab=e=>{const t=document.querySelectorAll(".tab-selection");for(let e of t)e.classList.remove("selected"),e.style.display="none";document.querySelector(`.${e} .tab-selection`).classList.add("selected")},setMapCountryCenter=(e,t,a)=>{map.setZoom(a),map.panTo({lat:e,lng:t})},getCountriesData=()=>{fetch("https://corona.lmao.ninja/v2/countries").then(e=>e.json()).then(e=>{coronaGlobalData=e,setCountrySelection(e),showDataOnMap(e);let t=sortData(e);showDataInTable(t)})},sortData=e=>{let t=[...e];return t.sort((e,t)=>e.cases>t.cases?-1:1),t},setCountrySelection=e=>{let t=[];t.push(worldwideSelect),e.forEach(e=>{t.push({name:e.country,value:e.countryInfo.iso2})}),startUIDropdown(t)},getCountryCoronaData=e=>{fetch(`https://disease.sh/v3/covid-19/countries/${e}`).then(e=>e.json()).then(e=>{updateDate(e.updated),setStatsData(e),setMapCountryCenter(e.countryInfo.lat,e.countryInfo.long,3)})},getWorldCoronaData=()=>{fetch("https://disease.sh/v3/covid-19/all").then(e=>e.json()).then(e=>{updateDate(e.updated),setStatsData(e),setMapCountryCenter(mapCenter.lat,mapCenter.lng,2)})},setStatsData=e=>{let t=numeral(e.todayCases).format("+0,0"),a=numeral(e.todayRecovered).format("+0,0"),o=numeral(e.todayDeaths).format("+0,0"),n=numeral(e.cases).format("0.0a"),l=numeral(e.recovered).format("0.0a"),r=numeral(e.deaths).format("0.0a");document.querySelector(".total-number").innerHTML=t,document.querySelector(".recovered-number").innerHTML=a,document.querySelector(".deaths-number").innerHTML=o,document.querySelector(".cases-total").innerHTML=`${n} Total`,document.querySelector(".recovered-total").innerHTML=`${l} Total`,document.querySelector(".deaths-total").innerHTML=`${r} Total`},getHistoricalData=()=>{fetch("https://corona.lmao.ninja/v2/historical/all?lastdays=120").then(e=>e.json()).then(e=>{let t=buildChartData(e);buildChart(t)})},openInfoWindow=()=>{infoWindow.open(map)},showDataOnMap=(e,t="cases")=>{e.map(e=>{let a={lat:e.countryInfo.lat,lng:e.countryInfo.long};var o=new google.maps.Circle({strokeColor:casesTypeColors[t],strokeOpacity:.8,strokeWeight:2,fillColor:casesTypeColors[t],fillOpacity:.4,map:map,center:a,radius:e[t]});mapCircles.push(o);var n=`\n            <div class="info-container">\n                <div class="info-flag" style="background-image: url(${e.countryInfo.flag});">\n                </div>\n                <div class="info-name">\n                    ${e.country}\n                </div>\n                <div class="info-confirmed">\n                    Total: ${numeral(e.cases).format("0,0")}\n                </div>\n                <div class="info-recovered">\n                    Recovered: ${numeral(e.recovered).format("0,0")}\n                </div>\n                <div class="info-deaths">   \n                    Deaths: ${numeral(e.deaths).format("0,0")}\n                </div>\n            </div>\n        `,l=new google.maps.InfoWindow({content:n,position:o.center});google.maps.event.addListener(o,"mouseover",function(){l.open(map)}),google.maps.event.addListener(o,"mouseout",function(){l.close()})})},showDataInTable=e=>{var t="";e.forEach(e=>{t+=`\n        <tr>\n            <td>${e.country}</td>\n            <td class="table-cases-number" >${numeral(e.cases).format("0,0")}</td>\n        </tr>\n        `}),document.getElementById("table-data").innerHTML=t};